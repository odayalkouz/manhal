var animationProperity = [
    {animationname:"bounce",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/bounce.svg",col:[""]},
    {animationname:"flash",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/flash.svg",col:[""]},
    {animationname:"pulse",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/pulse.svg",col:[""]},
    {animationname:"rubberBand",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/rubber.svg",col:[""]},
    {animationname:"swing",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/swing.svg",col:[""]},
    {animationname:"tada",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/tada.svg",col:[""]},
    {animationname:"wobble",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/wobble.svg",col:[""]},
    {animationname:"jello",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/jello.svg",col:[""]},
    {animationname:"holeOut",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/holeOut.svg",col:[""]},
    {animationname:"holeOutIn",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/holeOutIn.svg",col:[""]},
    {animationname:"swap",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/swap.svg",col:[""]},
    {animationname:"bigEntrance",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/bigEntrance.svg",col:[""]},
    {animationname:"hatch",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/hatch.svg",col:[""]},
    {animationname:"floating",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/floating.svg",col:[""]},
    {animationname:"tossing",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/tossing.svg",col:[""]},
    {animationname:"menagerie",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/menagerie.svg",col:[""]},
    {animationname:"Bouncing Entrances",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/BouncingEntrances.svg",col:["bounceIn","bounceInDown","bounceInLeft","bounceInRight","bounceInUp"]},
    {animationname:"Bouncing Exits",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/BouncingExits.svg",col:["bounceOut","bounceOutIn","bounceOutDown","bounceOutDownUp","bounceOutLeft","bounceOutLeftCenter","bounceOutRight","bounceOutRightCenter","bounceOutUp","bounceOutUpDown","bounceToLeftStartFromRight","bounceToRightStartFromleft","bounceToTopStartFromBottom","bounceToBottomStartFromTop"]},
    {animationname:"Fading Entrances",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/FadingEntrances.svg",col:["fadeIn","fadeInDown","fadeInDownBig","fadeInLeft","fadeInLeftBig","fadeInRight","fadeInRightBig","fadeInUp","fadeInUpBig"]},
    {animationname:"Fading Exits",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/FadingExits.svg",col:["fadeOut","fadeOutDown","fadeOutDownUp","fadeOutDownBig","fadeOutDownUpBig","fadeOutLeft","fadeOutLeftRight","fadeOutLeftBig","fadeOutLeftRightBig","fadeOutRight","fadeOutRightLeft","fadeOutRightBig","fadeOutRightLeftBig","fadeOutUp","fadeOutUpDown","fadeOutUpBig","fadeOutUpDownBig"]},
    {animationname:"Flippers",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/Flippers.svg",col:["flip","flipInX","flipInY","flipOutX","flipOutInX","flipOutY"]},
    {animationname:"open",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/open.svg",col:["openDownLeft","openUpLeft","openDownRight","openUpLeft","openUpRight","openDownLeftRetourn","openDownRightRetourn","openUpLeftRetourn","openUpRightRetourn","openDownLeftOut","openDownRightOut","openUpLeftOut","openUpRightOut"]},
    {animationname:"Lightspeed",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/Lightspeed.svg",col:["lightSpeedIn","lightSpeedOut","lightSpeedOutIn"]},
    {animationname:"puff",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/puff.svg",col:["puffIn","puffOut","puffOutIn"]},
    {animationname:"expand",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/expand.svg",col:["expandUp","expandOpen"]},
    {animationname:"twister",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/twister.svg",col:["twisterInDown","twisterInUp"]},
    {animationname:"vanish",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/vanish.svg",col:["vanishIn","vanishOut","vanishOutIn"]},
    {animationname:"swash",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/swash.svg",col:["swashOut","swashOutIn","swashIn"]},
    {animationname:"bomb",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/bomb.svg",col:["bombRightOut","bombRightOutIn","bombLeftOut","bombLeftOutIn"]},
    {animationname:"boing",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/boing.svg",col:["boingInUp","boingOutDown","boingOutInDown"]},
    {animationname:"pull",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/pull.svg",col:["pullUp","pullDown"]},
    {animationname:"stretch",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/stretch.svg",col:["stretchLeft","stretchRight"]},
    {animationname:"Rotating Entrances",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/RotatingEntrances.svg",col:["rotateIn","rotateFullWithOclock","rotateFullreverceOclock","rotateFullWithOclockAlternate","rotateFullreverceOclockAlternate","rotateInDownLeft","rotateInDownRight","rotateInUpLeft","rotateInUpRight","rotateDown","rotateDownUp","rotateLeft","rotateLeftRight","rotateRight","rotateRightLeft","rotateUp","rotateUpDown"]},
    {animationname:"Rotating Exits",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/RotatingExits.svg",col:["rotateOut","rotateOutDownLeft","rotateOutDownRight","rotateOutUpLeft","rotateOutUpRight"]},
    {animationname:"Sliding Entrances",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/SlidingEntrances.svg",col:["slideInUp","slideInDown","slideInLeft","slideInRight","slideDown","slideDownUp","slideLeft","slideLeftRight","slideRight","slideRightLeft","slideUp","slideUpDown","slideLeftRetourn","slideRightRetourn","slideUpRetourn","slideExpandUp"]},
    {animationname:"Sliding Exits",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/SlidingExits.svg",col:["slideOutUp","slideOutDown","slideOutLeft","slideOutRight"]},
    {animationname:"Zoom Entrances",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/ZoomEntrances.svg",col:["zoomIn","zoomInDown","zoomInLeft","zoomInRight","zoomInUp"]},
    {animationname:"perspective",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/perspective.svg",col:["perspectiveDown","perspectiveDownUp","perspectiveLeft","perspectiveLeftRight","perspectiveRight","perspectiveRightLeft","perspectiveUp","perspectiveUpDown","perspectiveDownRetourn","perspectiveLeftRetourn","perspectiveRightRetourn","perspectiveUpRetourn",]},
    {animationname:"space",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/space.svg",col:["spaceOutUp","spaceOutUpDown","spaceOutRight","spaceOutRightLeft","spaceOutDown","spaceOutDownUp","spaceOutLeft","spaceOutLeftRight","spaceInUp","spaceInRight","spaceInDown","spaceInLeft"]},
    {animationname:"tin",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/tin.svg",col:["tinRightOut","tinLeftOut","tinUpOut","tinDownOut","tinRightIn","tinLeftIn","tinUpIn","tinDownIn"]},
    {animationname:"Zoom Exits",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/ZoomExits.svg",col:["zoomOut","zoomOutIn","zoomOutDown","zoomOutLeft","zoomOutRight","zoomOutUp"]},
    {animationname:"Specials",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/Specials.svg",col:["hinge","rollIn","rollOut","rollOutIn","magic","magicUp"]},
    {animationname:"shake",url:""+window.SITE_URL+"storyeditor/thems/anmationimages/shake.svg",col:["shake","shake-little","shake-slow","shake-horizontal","shake-vertical","shake-crazy","shake-hard","shake-rotate","shake-opacity","shake-chunk"]},
];
var imageUrl="";
function drowAnimationArray(){
    var htmldivs='';
    for (i = 0; i < animationProperity.length; i++) {
        htmldivs+='<li onclick="animationItemClick(this)" idvalue="'+ i +'" id="animationItem'+ i +'" class="floating-left"><a><label style="background:url('+animationProperity[i].url+');"></label> <span value="'+animationProperity[i].animationname+'">'+animationProperity[i].animationname+'</span></a></li>';
    }
    $(".slider-content-animation").append(htmldivs);
    $(".slider-content-animation li:first-child").addClass("active");
}
function animationItemClick(e) {
    $(e).addClass("active").siblings().removeClass("active");
    var animationname=""
    var indexitem=$(e).attr("idvalue");
    var htmldivs1='';
    htmldivs1+='<select class="floating-left">';
    // htmldivs1+='<option value=".........">.........</option>';
    for (y = 0; y < animationProperity[indexitem].col.length; y++){
        if(animationProperity[indexitem].col[y]!=""){

            htmldivs1+='<option value="'+animationProperity[indexitem].col[y]+'" class="'+animationProperity[indexitem].col[y]+'">'+animationProperity[indexitem].col[y]+'</option>';
            $(".jq_Show_Effect").removeClass("add-opacity");
        }else{
            htmldivs1='';
            $(".jq_Show_Effect").addClass("add-opacity");
        }
    }
    htmldivs1+='</select>';
    $(".right-slider-content .show-effect-content").html(htmldivs1);
    if(!$(".show-effect-content select").length == 0){
        $(".item_popup_animation #demoImageAnimation1").attr("class","");
        $(".item_popup_animation #demoImageAnimation1").addClass("animated "+$(".show-effect-content select").find("option:first-child").val())

        $('.show-effect-content select').on('change', function(){
            $(".item_popup_animation #demoImageAnimation1").attr("class","");
            $(".item_popup_animation #demoImageAnimation1").addClass("animated "+this.value)
        });
    }
    else{
        $(".item_popup_animation #demoImageAnimation1").attr("class","");
        $(".item_popup_animation #demoImageAnimation1").addClass("animated "+$(e).children("a").children("span").attr("value"))
    }
}
function readURL(input,id)
{
    if (input.files && input.files[0])
    {
        var reader = new FileReader();
        reader.onload = function (e) {
            // document.getElementById(id).src=e.target.result;
            resizedataURL(e.target.result, 200, 200,id);
            $("#"+id).attr("updated","1");
        }
        reader.readAsDataURL(input.files[0]);
    }
}
function stopAllAudio(){
    $("audio").each(function () {
        $(this)[0].pause();
    });
}

function resizedataURL(datas, wantedWidth, wantedHeight,id)
{
    // We create an image to receive the Data URI
    var img = document.createElement('img');
    // When the event "onload" is triggered we can resize the image.
    img.onload = function()
    {
        // We create a canvas and get its context.
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
        // We set the dimensions at the wanted size.
        canvas.width = wantedWidth;
        canvas.height = wantedHeight;
        // We resize the image with the canvas method drawImage();
        ctx.drawImage(this, 0, 0, wantedWidth, wantedHeight);
        var dataURI = canvas.toDataURL();
        document.getElementById(id).src=dataURI
        /////////////////////////////////////////
        // Use and treat your Data URI here !! //
        /////////////////////////////////////////
    };
    // We put the Data URI in the image's src attribute
    img.src = datas;
}
function tutorialAnimation(x,timeOut) {
    var actualtimeout=600;
    setTimeout(function () {
        $(".tooltip:eq("+ x +")").attr("data-balloon-visible", "");
        $(".tooltip:eq("+ x +")").addClass("data-balloon-visible");
    }, timeOut);
    setTimeout(function () {
        $(".tutorial-icon").css("display","block");
        $(".tutorial-icon").addClass("move");
        $(".tutorial-icon").attr("data-balloon-visible", "");
        $(".tutorial-icon").addClass("data-balloon-visible");
    }, $(".tooltip").length*actualtimeout);
}
function moveUpAnimation(item) {
    $(".arrow-down,.arrow-up").removeClass("disabled");
    var prev = item.prev();
    if (prev.length == 0 || prev.length == "" || prev.length == "undefined" || prev.length == undefined || prev.length == -1){
    $(".arrow-up").addClass("disabled");
        return;
    }
    else {
        prev.css('z-index', 999).css('position','relative').animate({ top: item.height() }, 250);
        item.css('z-index', 1000).css('position', 'relative').animate({ top: '-' + prev.height() }, 300, function () {
            prev.css('z-index', '').css('top', '').css('position', '');
            item.css('z-index', '').css('top', '').css('position', '');
            item.insertBefore(prev);
        });
    }
}
function moveDownAnimation(item) {
    $(".arrow-down,.arrow-up").removeClass("disabled");
    var next = item.next();
    if (next.length == 0 || next.length == "" || next.length == "undefined" || next.length == undefined || next.length == -1){
        $(".arrow-down").addClass("disabled");
        return;
}
    else {
        next.css('z-index', 999).css('position', 'relative').animate({ top: '-' + item.height() }, 250);
        item.css('z-index', 1000).css('position', 'relative').animate({ top: next.height() }, 300, function () {
        next.css('z-index', '').css('top', '').css('position', '');
        item.css('z-index', '').css('top', '').css('position', '');
        item.insertAfter(next);
    });
    }

}



$(document).ready(function () {
    drowAnimationArray();
    $(document).on("change", ".jq_animation_action", function () {
        $(".jq_timer_input").slideUp();
        var valueAction= this.value;
        switch (valueAction) {
            case "OnClick":
                break;
            case "WithPrevious":
                break;
            case "AfterPrevious":
                break;
            case "Timer":
                $(".jq_timer_input").slideDown();
                break;
        }
    });
    $(document).on("click mousedown", ".jq_row_animation_items li", function () {
        $(this).addClass("selected").siblings().removeClass("selected")
    });

    $(".jq_row_animation_items").sortable({
        cursor: "move",
        placeholder: "selected",
        axis: 'y',
        animation:45,
        // items: ".jq_row_animation_items li.selected",
        distance: 10
    });
    $('.item_popup_animation .animation-pane-container .row-controls .navigation-animation a').click(function() {
        var val = $(this).attr("class");
        if (val == 'arrow-down floating-right'){
            moveDownAnimation($('.jq_row_animation_items li.selected'));
        }
        else{
            moveUpAnimation($('.jq_row_animation_items li.selected'));
        }
    });

    $('.item_popup_animation .delete-row-animation').click(function() {

        $(this).parent().remove()
    })






    $(".ruler-icon").click(function() {
        $(".ruler.h").fadeToggle();
        $(".ruler.v").fadeToggle();
        $(".ruler-icon i").toggleClass("display-block1");
    });
    $(".delete-image-a").click(function(e) {
        $("#audio-a").attr("src","")
    });


    $('#font_size').on('input change', function() {
        $("#font-val").val($(this).val())
    });
    $('#font-val').on('change input', function() {
        $("#font_size").val($(this).val())
    });


    $('#line_height').on('input', function() {
        $("#line-height-val").val($(this).val())
    });
    $('#line-height-val').on('change', function() {
        $("#line_height").val($(this).val())
    });

    //Start upload sound in browser
    $(".input-file-sound").change(function(e){
        var file = e.currentTarget.files[0];
        var objectUrl = URL.createObjectURL(file);
        var sourceid = $(this).parent().parent().children("audio");
        $(sourceid).prop("src", objectUrl);
    });
    //end upload sound in browser
    //Start Multiple images preview in browser
    var imagesPreview = function(input, placeToInsertImagePreview) {
        if (input.files) {
            $(placeToInsertImagePreview).html("");
            var filesAmount = input.files.length;
            for (i = 0; i < filesAmount; i++) {
                var reader = new FileReader();
                reader.onload = function(event) {
                    $($.parseHTML('<img>')).attr('src', event.target.result).appendTo(placeToInsertImagePreview);
                }
                reader.readAsDataURL(input.files[i]);
            }
        }
    };
    $('#screen-shoots-input').on('change', function() {
        imagesPreview(this, 'ul.screen-shoots');
    });
    $('#paint-picture-input').on('change', function() {
        imagesPreview(this, 'ul.paint-picture');
    });
    $('#games-pictures-input').on('change', function() {
        imagesPreview(this, 'ul.games-pictures');
    });
    //End Multiple images preview in browser
    //Start close all popups
    $(document).click(function(event) {
        if (!$(event.target).closest(".popup-settings-container,.settings-container,.settings-container *,.addQuestion,.popup-storytype-container,.editor-main-container .options-icons .settings,.jq_delete_screenshot").length) {
            hidesettingpopup();
        }
        else if (!$(event.target).closest(".addQuestion,.storytype-container,.storytype-container *").length) {
            hideeditpopup();
        }
    });
    //End close all popups
    //start main-settings-tabs-function 4 tabs
    $(document).on("click", ".popup-settings-container .settings-container .Tab", function () {
        $(".popup-settings-container .settings-container .Tab").removeClass("active");
        $(this).addClass("active").siblings().removeClass("active");
        var indexid=$(this).index()+1;
        $(".content-of-tab").hide();
        $(".content-of-tab:nth-child("+indexid+")").fadeIn();
    });
    //end main-settings-tabs-function 4 tabs

    //start sound-tabs-function
    $(document).on("click", "#popup-edit-sound-all-widget .tabs-buttons ul li a", function () {
        $("#popup-edit-sound-all-widget .tabs-buttons ul li a").removeClass("active");
        $(this).addClass("active").siblings().removeClass("active");
        var indexidA=$(this).parent("li").index()+1;
        $(".tabs-contents .tab").hide();
        $(".tabs-contents .tab:nth-child("+indexidA+")").fadeIn();
    });
    //end sound-tabs-function

    // colorpicker function

    $(document).on("click touch change", "#bg_color2", function () {
        $('#bg_color2').css('backgroundColor', '#' + jscolor);
        $('#bg_color2').attr('color','#' + this.jscolor);
    });
    $(document).on("click touch change", "#bg_color2_buttons", function () {
        $('#bg_color2_buttons').css('backgroundColor', '#' + jscolor);
        $('#bg_color2_buttons').attr('color','#' + this.jscolor);
    });

  $(document).on("click touch change", ".colorSelector .bordervalue", function () {
        $('.colorSelector .bordervalue').css('backgroundColor', '#' + this.jscolor);
        $('.colorSelector .border-value-color').css('border-color', '#' + this.jscolor);
        $('.colorSelector .bordervalue').attr('color',this.jscolor);
        $('.colorSelector .border-value-color').attr('color',this.jscolor);
    });






    // $('#item-settings #backgroundvalue').ColorPicker({
    //     color: '#7dc04d',
    //     onShow: function (colpkr) {
    //         $(colpkr).fadeIn(500);
    //         return false;
    //     },
    //     onHide: function (colpkr) {
    //         $(colpkr).fadeOut(500);
    //         return false;
    //     },
    //     onChange: function (hsb, hex, rgb) {
    //         $('.colorSelector .backgroundvalue').css('backgroundColor', '#' + hex);
    //         $('.colorSelector .backgroundvalue').attr('color',hex);
    //     }
    // });
    // $('#item-settings #bordervalue').ColorPicker({
    //     color: '#7dc04d',
    //     onShow: function (colpkr) {
    //         $(colpkr).fadeIn(500);
    //         return false;
    //     },
    //     onHide: function (colpkr) {
    //         $(colpkr).fadeOut(500);
    //         return false;
    //     },
    //     onChange: function (hsb, hex, rgb) {
    //         $('.colorSelector .bordervalue').css('backgroundColor', '#' + hex);
    //         $('.colorSelector .border-value-color').css('border-color', '#' + hex);
    //         $('.colorSelector .bordervalue').attr('color',hex);
    //         $('.colorSelector .border-value-color').attr('color',hex);
    //     }
    // });

    $("#border-selectoption").change(function() {
        $(".border-value-color").css("border-style",$(this).val())
    });
    //start change brder properitys
    $('input:radio[name="border"]').change(function(){
        if($(this).is(':checked')) {
            $("#border-selectoption").change(function() {
                $(".border-value-color").css("border-style",$(this).val())
            });
            $("input.border-width").change(function() {
                $(".border-value-color").css("border-width",$(this).val())
            });
        }
        });
    //End change brder properitys
    var actualtimeout=600;
    setTimeout(function (){
        for (i = 0; i < $(".tooltip").length; i++) {
            tutorialAnimation(i,i*actualtimeout);
        }
    }, 500);
    $(document).on("click", ".tutorial-icon", function () {
            $(this).removeClass("move");
        $(".tutorial-icon").removeAttr("data-balloon-visible", "");
        if (!$(".tooltip").hasClass("data-balloon-visible")) {
            $(".tooltip").addClass("data-balloon-visible");
            $(".tooltip").attr("data-balloon-visible", "");
            // $(this).addClass("move");
            $(".tutorial-icon").attr("data-balloon-visible", "");
        }
        else {
            $(".tooltip").removeClass("data-balloon-visible");
            $(".tooltip").removeAttr("data-balloon-visible", "")
        }
    });
    $(document).on("click", ".editor-main-container footer .content .rectangle-items-container .addQuestion,.editor-main-container .options-icons .settings,.editor-main-container footer .content .rectangle-items-container #slider ul li label i.edit", function () {
        $(".tooltip,.tutorial-icon").removeAttr("data-balloon-visible", "");
        $(".tooltip").removeClass("data-balloon-visible");
        $(".tutorial-icon").removeClass("move");
        setTimeout(function () {
            $(".tooltip,.tutorial-icon").removeAttr("data-balloon-visible", "");
            $(".tooltip").removeClass("data-balloon-visible");
            $(".tutorial-icon").removeClass("move");
        },2000);
    });
    /////////////////////////////////*******************************///////////////////////////////
    var indexofA = $(".editor-main-container footer .content .rectangle-items-container #slider ul li.active").index() + 1;
    $(".story-main-container .question-answer-container .num").eq(indexofA - 1).html(indexofA);
    /////////////////////////////////*******************************///////////////////////////////

    /////////////////////////////////*******************************///////////////////////////////
    $(".story-main-container .question-answer-container .answer .matching .left-container .box-container").resizable({
        animate: true,
        maxHeight: 300,
        handles: 's',
        alsoResize: ".story-main-container .question-answer-container .answer .matching .item,.story-main-container .question-answer-container .answer .matching .left-container .box-container,.story-main-container .question-answer-container .answer .matching .RIGHT-container .box-container"
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", ".delete_widget", function () {
        $(this).parent().remove();
    });
    /////////////////////////////////*******************************///////////////////////////////
    var slideCount = $('#slider ul li').length;
    var slideWidth = $('#slider ul li').outerWidth() + 8;
    var slideHeight = $('#slider ul li').height();
    var sliderUlWidth = slideCount * slideWidth;
    $('#slider').css({width: sliderUlWidth, height: slideHeight+9});

    function moveLeft() {
        // alert("left");
        // text( "scrollLeft:"
        if(parseInt($("#questions_slider").css("left").replace("px",""))==0){
            $(".control_prev").fadeOut();
        }else{
            var newLeft1 = parseInt($('#slider ul').css("left")) + slideWidth;
            $('#slider ul').animate({
                left: newLeft1,
            }, 'fast');
            $(".white-content").scrollLeft(newLeft1*-1);
            $('#slider ul').css("margin-right","0");
            $('#slider ul').css("margin-left","0");
            $(".control_next").fadeIn();
        }
    }
    var dist = sliderUlWidth - (parseInt($('#slider ul').css("left")) * -1+($("#questions_slider").width()-$(".addQuestion").width()));
    var test=-(sliderUlWidth-$(".editor-main-container footer .content .rectangle-items-container .white-content").width()+30);
    function moveRight() {
        // alert("right");
        if(dist<=0) {
            $(".control_next").fadeOut();
        }else{
            var newLeft = parseInt($('#slider ul').css("left")) - slideWidth;
            if(newLeft<=test){
                $(".control_next").fadeOut();
            }
            $('#slider ul').animate({
                left: newLeft
            }, 'fast');
            // alert(newLeft);
            $(".white-content").scrollLeft(newLeft*-1);

            $('#slider ul').css("margin-left","0");
            $('#slider ul').css("margin-right","51px");
            $(".control_prev").fadeIn();
        }
    }
    function posnterEvent() {
        $(".editor-main-container footer .content .rectangle-items-container a.control_prev").css("pointer-events","none");
        $(".editor-main-container footer .content .rectangle-items-container a.control_next").css("pointer-events","none");
        setTimeout(function () {
            $(".editor-main-container footer .content .rectangle-items-container a.control_prev").css("pointer-events","auto");
            $(".editor-main-container footer .content .rectangle-items-container a.control_next").css("pointer-events","auto");
        },250)
    }
    /////////////////////////////////*******************************///////////////////////////////
    function changenumofQuestion() {
        $(".editor-main-container footer .content .num-of-question label:nth-child(1)").html(slideCount);
    }
    /////////////////////////////////*******************************///////////////////////////////
    function changenumofQuestionActive() {
        $(".editor-main-container footer .content .num-of-question input").val($(".editor-main-container footer .content .rectangle-items-container #slider ul li.active").length);
    }
    /////////////////////////////////*******************************///////////////////////////////
    $('a.control_prev').click(function () {
        moveLeft();
        posnterEvent()
        // $('#slider').css({width: "100%", height: slideHeight});
        // $('#questions_slider').css({width: ""});
    });
    $('a.control_next').click(function () {
        moveRight();
        posnterEvent()
        // $('#slider').css({width: "100%", height: slideHeight});
        // $('#questions_slider').css({width: ""});
    });
    if (sliderUlWidth > $('.editor-main-container footer .content .rectangle-items-container .white-content').width()) {
        $(".control_next").fadeIn();
        $(".control_prev").fadeOut();
        // $("#questions_slider").css('width', '100%');
        // $("#slider").css('width', '100%');
    }
    else {
        $(".control_next").fadeOut();
    }
    /////////////////////////////////*******************************///////////////////////////////
    changenumofQuestion();
    changenumofQuestionActive();
    /////////////////////////////////*******************************///////////////////////////////
    $('.hamburger').click(function () {
        if (!$(this).hasClass("is-active")) {
            $(this).addClass("is-active");
            $(".editor-main-container footer").addClass("active");
            $(".editor-main-container footer .content .num-of-question").fadeIn(300);
            $(".story-main-container .content-container").removeClass("active");
        }
        else {
            $(this).removeClass("is-active");
            $(".editor-main-container footer").removeClass("active");
            $(".editor-main-container footer .content .num-of-question").fadeOut(300);
            $(".story-main-container .content-container").css("height", "calc(100%-90px)");
            $(".story-main-container .content-container").addClass("active");
        }
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", ".editor-main-menu-container .nav a", function () {
        var conID = $(this).attr("id");
        $(this).siblings().removeClass("active");
        switch (conID) {
            case "Page_menu":
                $(".element").removeClass("leyersA");
                $(this).siblings().removeClass("active");
                $(this).addClass("active");
                $("#page-content").fadeIn();
                // $("#page-content-buttons").fadeOut();
                $("#page-content-layers").fadeOut();

                // $("#action-content").fadeToggle();
                $(".droppable").toggleClass("active");
                $(".tooltip,.tutorial-icon").attr("data-balloon-visible", "");
                $(".tooltip").toggleClass("data-balloon-visible");
                $(".tutorial-icon").toggleClass("move");
                setTimeout(function () {
                    $(".tooltip,.tutorial-icon").removeAttr("data-balloon-visible", "");
                    $(".tooltip").removeClass("data-balloon-visible");
                    $(".tutorial-icon").removeClass("move");
                },2000);
                break;
            case "layers_manu":
                $(this).siblings().removeClass("active");
                $(".element").toggleClass("leyersA");

                $(this).addClass("active");
                $("#page-content").fadeOut();
                // $("#page-content-buttons").fadeOut();
                $("#page-content-layers").fadeIn();
                drawLaers();
                break;
            // case "buttons_manu":
            //     $(this).siblings().removeClass("active");
            //     $(this).addClass("active");
            //     $("#page-content").fadeOut();
            //     $("#page-content-layers").fadeOut();
            //     // $("#page-content-buttons").fadeIn();
            //     drawLaers();
            //     break;
        }
    });
    /////////////////////////////////*******************************///////////////////////////////
    // action script

    $(document).on("click", ".action-main-menu-container .nav a", function () {
        var conID = $(this).attr("id");
        switch (conID) {
            case "action_menu":
                $(this).toggleClass("active");
                $("#action-content-href").fadeToggle();
                break;
        }
    });


    // accordion script
    $(".accordion .accordion-item.is-active").children(".accordion-panel").slideDown();
    $(document).on("click",".accordion .openclose",function () {
        $(this).parent().parent().siblings(".accordion-item").removeClass("is-active").children(".accordion-panel").slideUp();
        $(this).parent().parent().toggleClass("is-active").children(".accordion-panel").slideToggle("ease-out");
    });

///////start activate choose thumb ////////
    $(document).on("click", ".select-object", function () {
        if(!$(this).hasClass("selected")){
            window.disableNavigation=true;
            $(this).addClass("selected");
            $("body").addClass("active-choose-state");
            $(".activate-choose-object-state").show();
        }else {
            window.disableNavigation=false;
            $(this).removeClass("selected");
            $("body").removeClass("active-choose-state");
            $(".activate-choose-object-state").hide();
        }
    });
    ///////end activate choose thumb ////////
    // $(document).on("click", ".story-main-container .move_handler", function () {
    //     $(this).closest(".element").addClass("selected");
    //     $(this).closest(".element").siblings().removeClass("selected");
    // });
    ///////start activate choose object////////
    $(document).on("click", ".Jq_select_object-thumb", function () {
        if(!$(this).hasClass("selected")) {
            window.disableElement=true;
            $(this).addClass("selected");
            $("body").addClass("active-choose-state-object");
            $(".activate-choose-thumb-state").show();
        }else{
            window.disableElement=false;
            $(this).removeClass("selected");
            $(".element").removeClass("selected");
            $("body").removeClass("active-choose-state-object");
            $(".activate-choose-thumb-state").hide();
        }
    });
    ///////start activate choose object////////
    $(document).on("click", ".delecte_action", function () {
        $(this).parent().parent().remove();
    });

    $(document).on("click", ".closeA", function () {
        CloseChooseEffect()
    });


    $(document).on('change','.jq_doAction select', function() {
        $(this).parent().parent().children(".Jq_target_Specific_page,.jq_Goto_URL,.select-object,.Jq_select_object-thumb,.Jq_next_prev_page,.Jq_show_message,.Jq_select_object-thumb1").hide();
        var valueDo= this.value;
        var temp;

        switch (valueDo) {
            case "Goto_Specific_Page":
                $(this).parent().parent().children(".Jq_target_Specific_page").show();
                $(this).parent().parent().children(".select-object").show();
                break;
            case "Open_popup":
                $(this).parent().parent().children(".Jq_target_Specific_page").show();
                $(this).parent().parent().children(".select-object").show();
                $(this).parent().parent().children(".jq_Goto_URL").show();

                break;
            case "Goto_URL":
                $(this).parent().parent().children(".jq_Goto_URL").show();

                break;
            case "Goto_Next_Page":
                $(this).parent().parent().children(".Jq_next_prev_page").show();

                break;
            case "Goto_Previous_Page":
                $(this).parent().parent().children(".Jq_next_prev_page").show();

                break;
            case "Play_Object":
            case "Show_Object":
            case "Hide_Object":
            case "ِAnimate_Object":
                $(this).parent().parent().children(".Jq_select_object-thumb1").show();
                temp=$(this).closest("li").find(".jq_select_object");
                temp.html("");
                $(".element").each(function () {
                    temp.append('<option value="'+$(this).attr("id")+'">#'+$(this).find(".content-of-index").val()+'</option>');
                });
                break;
            case "Show_message":
                $(this).parent().parent().children(".Jq_show_message").show();

                break;
        }
    });

    $(document).on("click", ".target-thumbs-container", function () {
        $(".thumb-container").fadeToggle();
        drawPageThumbs($(this).closest(".Jq_target_Specific_page").find(".thumb-container"));
    });
    $(document).on("click", ".thumb-container .item-thumb", function () {
           var srcattr =$(this).attr("thumbsrc");
           $(this).closest(".Jq_target_Specific_page").find(".select-thumb img").attr("src",srcattr);
           $(this).addClass("selected").siblings().removeClass("selected");
           $(this).closest(".Jq_target_Specific_page").attr("target-id",$(this).attr("data-id"));
    });
        /////////////////////////////////*******************************///////////////////////////////

    $(document).click(function (e) {
        if (typeof $(e.target).closest(".noclose,.ui-rotatable-handle,.element")[0] == "undefined") {

            $("#page-content").fadeOut();
            $("#page-content-layers").fadeOut();
            $("#page-content-buttons").fadeOut();
            $("#action-content").fadeOut();
            $(".editor-main-menu-container .nav a").removeClass("active");
            $(".droppable").removeClass("active");
            $(".popup-export-content").fadeOut();
            $(".thumb-container").fadeOut();
            $(".tooltip").removeClass("data-balloon-visible");
            $(".tooltip").removeAttr("data-balloon-visible", "");
            $(".element").addClass("leyersA");
        }
    });
    $(".export").click(function (e) {
        $(".popup-export-content").fadeToggle();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(".popup-delete-container .delete-container a").click(function () {
        hidedeletemessage();
    });
    $(".popup-confirm-container .confirm-container a").click(function () {
        hideconfirmmessage();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(".popup-questiontype-container .questiontype-container .items-container .item-container").click(function () {
        $(this).addClass("active").siblings().removeClass("active");
        window.selectedtype = $(this).attr("qtype");
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", ".story-main-container .question-answer-container .answer .click-map .edit-image", function () {
        $(".popup-edit-image-container.clickmap-1").fadeIn();
        $(".popup-edit-image-container.clickmap-1 .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(".popup-questiontype-container .questiontype-container .items-container .btn-save-container").click(function () {
        hideeditpopup();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $("#Edit-page-popup .storytype-container .close,#popup-edit-sound-all-widget .storytype-container .close,#do-you-know-popup .storytype-container .close,#item-settings .storytype-container .close,#popup-edit-iframe .storytype-container .close").click(function () {
        stopAllAudio();
        hideeditpopup();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(".editor-main-container .options-icons .settings").click(function () {
        showsettingpopup();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(".popup-settings-container .settings-container .close").click(function () {
        stopAllAudio();
        hidesettingpopup();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", ".story-main-container .edit_widget[widget_type='image']", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        $("#default-image-widget").attr("src",$(this).closest(".element").find("img").attr("src"));
        $(".popup-edit-image-container.itemA").fadeIn();
        $(".popup-edit-image-container.itemA .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });
    $(document).on("click", ".story-main-container .edit_widget[widget_type='audio']", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        // $("#default-image-widget").attr("src",$(this).closest(".element").find("img").attr("src"));

        $(".popup-edit-image-container.itemB audio").find("source").attr("src",$(this).closest(".element").find("source").attr("src"));
        $(".popup-edit-image-container.itemB audio")[0].load();

        $(".jq_is_splitter").val(0);
        $(".popup-edit-image-container.itemB").fadeIn();
        $(".popup-edit-image-container.itemB .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });
    $(document).on("click", ".story-main-container .edit_widget[widget_type='video']", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        // $("#default-image-widget").attr("src",$(this).closest(".element").find("img").attr("src"));
        $(".jq_is_splitter").val(0);
        $(".popup-edit-image-container.itemD").fadeIn();
        $(".popup-edit-image-container.itemD .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });


    var symID=null;
    $(document).on("click", ".story-main-container .Symbols_widget", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        symID=window.widgetID;
        $(".popup-edit-image-container.itemSymbols").fadeIn();
        $(".popup-edit-image-container.itemSymbols .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });

    $(document).on("click", "#add_symbol_widget", function () {
    var vals=$(".symbols-container .symbols-item.active").html();
        $("#"+ symID).find(".poplinable").html(vals);

        $(".popup-edit-image-container.itemSymbols").fadeOut();
        $(".popup-edit-image-container.itemSymbols .edit-image-container").addClass("slideOutUp").removeClass("animated slideInDown").fadeOut();
    });
    $(document).on("click", ".symbols-container .symbols-item", function () {
        $(this).addClass("active").siblings().removeClass("active");
        $("#add_symbol_widget").click();
    });

    var buttonID=null;
    $(document).on("click", ".story-main-container .buttons_widget", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        buttonID=window.widgetID;
        $(".popup-edit-image-container.itemButtons").fadeIn();
        $(".popup-edit-image-container.itemButtons .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });

    $(document).on("click", "#add_button_widget", function () {
    var vals=$(".itemButtons .buttons-container .buttons-item.active").html();
        $("#"+ buttonID).find(".real-content").html(vals);
        $(".popup-edit-image-container.itemButtons").fadeOut();
        $(".popup-edit-image-container.itemButtons .edit-image-container").addClass("slideOutUp").removeClass("animated slideInDown").fadeOut();

    });
    $(document).on("click", ".itemButtons .buttons-container .buttons-item", function () {
        setTimeout(function () {
            refreshElement();
        },50);
        $(this).addClass("active").siblings().removeClass("active");
        $("#add_button_widget").click();
    });


//Start bg animations
    var bganimationID=null;
    $(document).on("click", ".story-main-container .bganimation_widget", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        bganimationID=window.widgetID;
        $(".popup-edit-image-container.itemBgAnimation").fadeIn();
        $(".popup-edit-image-container.itemBgAnimation .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });
    $(document).on("click", ".itemBgAnimation .buttons-container .buttons-item", function () {
        var vals1=$(this).attr("URLiframes");
        $(".view-iframe-contntent iframe").attr("src",vals1);
    });
    $(document).on("click", "#add_bganimation_widget", function () {
        var vals1=$(".itemBgAnimation .buttons-container .buttons-item.active").attr("URLiframes");
        $("#"+ bganimationID).find(".real-content iframe").attr("src",vals1);
        $(".view-iframe-contntent iframe").attr("src",vals1);
        $(".popup-edit-image-container.itemBgAnimation").fadeOut();
        $(".popup-edit-image-container.itemBgAnimation .edit-image-container").addClass("slideOutUp").removeClass("animated slideInDown").fadeOut();
    });
    $(document).on("click", ".itemBgAnimation .buttons-container .buttons-item", function () {
        setTimeout(function () {
            refreshElement();
        },50);
        $(this).addClass("active").siblings().removeClass("active");
        // $("#add_bganimation_widget").click();
    });
//End bg animations







    $(document).on("click", ".story-main-container .edit_widget[widget_type='Iframe']", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        $("#iframe_widget").val($(this).closest(".element").find("iframe").attr("src"));
        $("#popup-edit-iframe").fadeIn();
        $("#popup-edit-iframe .storytype-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });
    $(document).on("click", ".story-main-container .setting_widget[widget_type='text'],.story-main-container .setting_widget[widget_type='video'],.story-main-container .setting_widget[widget_type='audio'],.story-main-container .setting_widget[widget_type='image'],.story-main-container .setting_widget[widget_type='Iframe'],.story-main-container .setting_widget[widget_type='LeftBallon'],.story-main-container .setting_widget[widget_type='RightBallon'],.story-main-container .setting_widget[widget_type='DoyouKnow']", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        $("#widget_setting_form")[0].reset();
        $("#item-settings").fadeIn();
        $("#item-settings .storytype-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
        if($("#"+window.widgetID).attr("bgcolor")=="" || $("#"+window.widgetID).attr("bgcolor")==undefined || $("#"+window.widgetID).attr("bgcolor")=="undefined" || $("#"+window.widgetID).attr("bgcolor")=="fff"){
            $("#no_backgroundp").click();
            $("#bg_color2").attr("color","7dc04d");
            $("#bg_color2").css("background-color","#7dc04d");
        }else{
            $("#backgroundp").click();
            $("#bg_color2").attr("color",$("#"+window.widgetID).attr("bgcolor"));
            $("#bg_color2").css("background-color","#"+$("#"+window.widgetID).attr("bgcolor"));
        }

        if($("#"+window.widgetID).attr("border_color")=="" || $("#"+window.widgetID).attr("border_color")==undefined || $("#"+window.widgetID).attr("border_color")=="undefined" || $("#"+window.widgetID).attr("border_color")=="fff"){
            $("#no_border2").click();
            $("#bordervalue2").attr("color","7dc04d");
            $("#bordervalue2").css("background-color","#7dc04d");
            $(".border-value-color").css('border-color',"#7dc04d");
            $("#bordersize1").val(1);

        }else{
            $("#with_border2").click();
            $("#bordervalue2").attr("color",$("#"+window.widgetID).attr("border_color"));
            $("#bordervalue2").css("background-color","#"+$("#"+window.widgetID).attr("border_color"));
            $(".border-value-color").css('border-color',"#"+$("#"+window.widgetID).attr("border_color"));

            $("#bordersize1").val($("#"+window.widgetID).attr("border_size"))
        }

        if($("#"+window.widgetID).attr("timeDelay")=="" || $("#"+window.widgetID).attr("timeDelay")==undefined || $("#"+window.widgetID).attr("timeDelay")=="undefined" || $("#"+window.widgetID).attr("timeDelay")=="-1"){
            $("#no_Appearance2").click();
            $("#delay_item").val(0);
        }else{
            $("#no_Appearance2").attr("checked",false);
            $("#delay_item").val($("#"+window.widgetID).attr("timeDelay"));
        }
    });


    $(document).on("click", ".story-main-container .setting_buttons_widget", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        $("#widget_setting_form")[0].reset();
        $("#item-settings-buttons").fadeIn();
        $("#item-settings-buttons .storytype-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();

        if($("#"+window.widgetID).attr("bgcolor")=="" || $("#"+window.widgetID).attr("bgcolor")==undefined || $("#"+window.widgetID).attr("bgcolor")=="undefined" || $("#"+window.widgetID).attr("bgcolor")=="fff"){
            $("#no_backgroundp_buttons").click();
            $("#bg_color2_buttons").attr("color","7dc04d");
            $("#bg_color2_buttons").css("background-color","#7dc04d");
        }else{
            $("#backgroundp_buttons").click();
            $("#bg_color2_buttons").attr("color",$("#"+window.widgetID).attr("bgcolor"));
            $("#bg_color2_buttons").css("background-color","#"+$("#"+window.widgetID).attr("bgcolor"));
        }
    });

    $(document).on("click", ".story-main-container .audio_widget", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        if($(this).closest(".element").attr("voice")!="undefined" && $(this).closest(".element").attr("voice")!=undefined && $(this).closest(".element").attr("voice")!=""){
            $(".popup-edit-image-container.itemB audio").find("source").attr("src",$("#"+window.widgetID).attr("voice")).addClass("pointer");
        }else{
            $(".popup-edit-image-container.itemB audio").find("source").attr("src","").removeClass("pointer");

        }
        $(".popup-edit-image-container.itemB audio")[0].load();
            $(".jq_is_splitter").val(1);
            $(".popup-edit-image-container.itemB").fadeIn();
            $(".popup-edit-image-container.itemB .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();

    });

    $(document).on("click", ".story-main-container .audio_sync", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        if($(this).closest(".element").attr("voice")!="undefined" && $(this).closest(".element").attr("voice")!=undefined && $(this).closest(".element").attr("voice")!=""){
            $voice=$("#"+window.widgetID).attr("voice");
        }else{
            $voice=0;
        }
        $("#sync_iframe").attr("src",SITE_URL+"storyeditor/sync.php?id="+window.widgetID+"&voice="+$voice);
        $(".popup-edit-image-container .jq_sync_div").fadeIn();
        $(".popup-edit-image-container.itemF").fadeIn();
    });

    $(document).on("click", ".story-main-container .fontsize_widget", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        $(".popup-edit-image-container.itemC").fadeIn();
        $(".popup-edit-image-container.itemC .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
        var size1= parseFloat($("#"+window.widgetID).find(".real-content").children("span").css('font-size'));
        var lineheight1= parseFloat($("#"+window.widgetID).find(".real-content").children("span").css('line-height'));
        setTimeout(function () {
            $("#font_size").val(size1);
            $("#font-val").val(size1);
            $("#line_height").val(lineheight1);
            $("#line-height-val").val(lineheight1);
        },100)
    });
    $(document).on("click", ".story-main-container .animation_widget_new", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        $(".popup-edit-image-container.item_popup_animation").fadeIn();
        $(".popup-edit-image-container.item_popup_animation .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });

    $(document).on("click", ".story-main-container .animation_widget", function () {
        window.widgetID = $(this).closest(".element").attr("id");
        $("#animation_container").html('');
        var flag=false;
        $(".popup-edit-image-container.itemE").fadeIn();
        $(".popup-edit-image-container.itemE .edit-image-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();

        $("#animation_object").html('<div id="demoImageAnimation">'+$("#"+window.widgetID+" .real-content").html()+'</div>');

        animated=$("#"+window.widgetID).find(".animated");
        if(animated[0] !=undefined && animated[0].hasAttribute("default-animation") && animated.attr("default-animation")!=""){
            flag=true;
            $("#animation_container").html('<a class="line-row-d jq_animation" data-animation-type="default" data-animation="bounce" data-time="1000">\n' +
                '                            <label class="floating-left lbl-data-a">Animation</label>\n' +
                '                            <select class="ddl-animation-action txt-a jq_animation_type floating-left">\n' +
                '                                <option value="default">Default</option>\n' +
                '                                <option value="click">On Click</option>\n' +
                '                                <option value="timer">Timer</option>\n' +
                '                            </select>\n' +
                '                            <div class="delete-animation"><i class="flaticon-delete96"></i></div>\n' +
                '                        </a>');
            $(".jq_animation").first().attr("data-animation-type","default");
            $(".jq_animation").first().attr("data-animation",animated.attr("default-animation"));
        }
        if(animated!=null && animated!=undefined){
            if(animated.attr("data-animation")!="" && animated.attr("data-animation")!=undefined){
                flag=true;
                arr=animated.attr("data-animation").split("@");
                html='<a class="line-row-d jq_animation " data-animation-type="click" data-animation="'+arr[0]+'" data-time="1000" data-sound="'+arr[2].replace(",","")+'"> <div class="delete-animation"><i class="flaticon-delete96"></i></div> <label class="floating-left lbl-data-a">Animation</label> <select class="ddl-animation-action txt-a jq_animation_type"> <option value="default">Default</option> <option value="click" selected="selected">On Click</option> <option value="timer">Timer</option> </select> </a>';
                $("#animation_container").append(html);
                if(arr[1]=='ture'){
                    $("#jq_timer").slideDown();
                }
            }
            if(animated.attr("data-animation-timer")!="" && animated.attr("data-animation-timer")!=undefined){
                var animation_timer=animated.attr("data-animation-timer").split(",");
                for(var i=0;i<animation_timer.length;i++){
                    if(animation_timer[i]!=""){
                        flag=true;
                        arr=animation_timer[i].split("@");
                        html='<a class="line-row-d jq_animation " data-animation-type="timer" data-animation="'+arr[0]+'" data-time="'+arr[1]+'" data-sound=""> <div class="delete-animation"><i class="flaticon-delete96"></i></div> <label class="floating-left lbl-data-a">Animation</label> <select class="ddl-animation-action txt-a jq_animation_type"> <option value="default">Default</option> <option value="click" >On Click</option> <option value="timer" selected="selected">Timer</option> </select> </a>';
                        $("#animation_container").append(html);
                        if(arr[1]=='ture'){
                            $("#jq_timer").slideDown();
                        }
                    }

                }

            }

        }
        if(!flag){
            $("#animation_container").html('<a class="line-row-d jq_animation" data-animation-type="default" data-animation="bounce" data-time="1000">\n' +
                '                            <label class="floating-left lbl-data-a">Animation</label>\n' +
                '                            <select class="ddl-animation-action txt-a jq_animation_type floating-left">\n' +
                '                                <option value="default">Default</option>\n' +
                '                                <option value="click">On Click</option>\n' +
                '                                <option value="timer">Timer</option>\n' +
                '                            </select>\n' +
                '                            <div class="delete-animation"><i class="flaticon-delete96"></i></div>\n' +
                '                        </a>');
        }
        $(".jq_animation").first().addClass("selected");
    });

    $(document).on("click", ".story-main-container .edit_widget[widget_type='DoyouKnow']", function () {
        window.widgetID = $(this).closest(".element").attr("id");

        var icon=$(this).closest(".element").attr("icon");
        if(icon=="" || icon=="undefined" || icon==undefined){
            icon=SITE_URL+"storyeditor/thems/En/images/imagedef.svg";
        }

        var img=$(this).closest(".element").attr("img");
        if(img=="" || img=="undefined" || img==undefined){
            img=SITE_URL+"storyeditor/thems/En/images/imagedef.svg";
        }
        var txt=$(this).closest(".element").attr("txt");
        if(txt=="" || txt=="undefined" || txt==undefined){
            txt="";
        }

        $("#default-image-doyouknow-icon").attr("src",icon);
        $("#default-image-doyouknow").attr("src",img);
        $("#douknow_txt").val(txt);

        $("#do-you-know-popup").fadeIn();
        $("#do-you-know-popup .storytype-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
    });

    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", ".popup-edit-video-container .edit-video-container .close", function () {
        stopAllAudio();
        $(".popup-edit-video-container").fadeOut();
        $(".popup-edit-video-container .edit-video-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", ".popup-edit-sound-container .edit-sound-container .close", function () {
        stopAllAudio();
        $(".popup-edit-sound-container").fadeOut();
        $(".popup-edit-sound-container .edit-sound-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", ".popup-edit-image-container .edit-image-container .close", function () {
        stopAllAudio();
        $(".popup-edit-image-container").fadeOut();
        $(".popup-edit-image-container .edit-image-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("click", "#popup-edit-sound-all-widget .play-image,#popup-edit-sound-all-widget .sound-image", function () {
        $(this).toggleClass("active")
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("change", "input[type=file]", function () {
        conID = $(this).attr("id");
        $("#lbl" + conID).html($("#" + conID).val());
    });
    /////////////////////////////////*******************************///////////////////////////////
    $(document).on("change", "select", function () {
        conID = $(this).attr("id");
        $("#lbl" + conID).html($("#" + conID + " option:selected").text());
    });

});
/////////////////////////////////*******************************///////////////////////////////
function showdeletemessage() {
    $(".popup-delete-container").fadeIn();
    $(".popup-delete-container .delete-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
}
/////////////////////////////////*******************************///////////////////////////////
function hidedeletemessage() {
    $(".popup-delete-container").fadeOut();
    $(".popup-delete-container .delete-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
}
/////////////////////////////////*******************************////////////////////////////////////////////////////////////////*******************************///////////////////////////////
/////////////////////////////////*******************************///////////////////////////////
function hideconfirmmessage() {
    $(".popup-confirm-container").fadeOut();
    $(".popup-confirm-container .confirm-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
}
/////////////////////////////////*******************************///////////////////////////////
function showeditpopup() {
    $("#Edit-page-popup").fadeIn();
    $("#Edit-page-popup .storytype-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
}
/////////////////////////////////*******************************///////////////////////////////
function hideeditpopup() {
    $("#Edit-page-popup").fadeOut();
    $("#Edit-page-popup .storytype-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    $("#do-you-know-popup").fadeOut();
    $("#do-you-know-popup .storytype-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    $("#item-settings").fadeOut();
    $("#item-settings .storytype-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    $("#item-settings-buttons").fadeOut();
    $("#item-settings-buttons .storytype-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    $("#popup-edit-iframe").fadeOut();
    $("#popup-edit-iframe .storytype-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    $("#popup-edit-sound-all-widget").fadeOut();
    $("#popup-edit-sound-all-widget .storytype-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
    if(typeof wavesurfer!=undefined && typeof wavesurfer!="undefined"){
        wavesurfer.destroy();
    }

}
/////////////////////////////////*******************************///////////////////////////////
function showsettingpopup() {
    $("[name='viewtype']").change();
    $(".popup-settings-container").fadeIn();
    $(".popup-settings-container .settings-container").removeClass("slideOutUp").addClass("animated slideInDown").fadeIn();
}
/////////////////////////////////*******************************///////////////////////////////
function hidesettingpopup() {
    $(".popup-settings-container").fadeOut();
    $(".popup-settings-container .settings-container").removeClass("slideInDown").addClass("slideOutUp").fadeOut();
}
function closeAnimationPopup() {
    $(".popup-edit-image-container.itemE .edit-image-container").addClass("slideOutUp").removeClass("animated slideInDown").fadeOut();
    $(".popup-edit-image-container.itemE").fadeOut();
}
/////////////////////////////////*******************************///////////////////////////////



function isArabic(strInput) {
    var arregex = /[\u0600-\u06FF]/;
    if (arregex.test(strInput)){
        // alert('Yes, Has Arabic Characters');
        $(".textContainer").css("direction","rtl");
    }else{
        // alert('No, Has Not Arabic Characters');
        $(".textContainer").css("direction","ltr");
    }
}
function CloseChooseEffect() {
    $("body").removeClass("active-choose-state");
    $(".activate-choose-object-state").hide();
    $("body").removeClass("active-choose-state-object");
    $(".Jq_select_object-thumb").removeClass("selected");
    $(".select-object").removeClass("selected");
    $(".activate-choose-thumb-state").hide();
}




function calculateTotalValue(length) {
    var minutes = Math.floor(length / 60),
        seconds_int = length - minutes * 60,
        seconds_str = seconds_int.toString(),
        seconds = seconds_str.substr(0, 2),
        time = minutes + ':' + seconds

    return time;
}

function calculateCurrentValue(currentTime) {
    var current_hour = parseInt(currentTime / 3600) % 24,
        current_minute = parseInt(currentTime / 60) % 60,
        current_seconds_long = currentTime % 60,
        current_seconds = current_seconds_long.toFixed(),
        current_time = (current_minute < 10 ? "0" + current_minute : current_minute) + ":" + (current_seconds < 10 ? "0" + current_seconds : current_seconds);

    return current_time;
}


function initProgressBar(pl) {
    var player = pl;
    // console.log("player",pl);
    var length = player.duration;
    var current_time = player.currentTime;

    // calculate total length of value
    var totalLength = calculateTotalValue(length);
    $(pl).closest(".audio-player").find(".end-time").html(totalLength);

    // calculate current value time
    var currentTime = calculateCurrentValue(current_time);

    $(pl).closest(".audio-player").find(".start-time").html(currentTime);



    var progressbar = $(pl).closest(".audio-player").find('.seekObj')[0];
    progressbar.value = (player.currentTime / player.duration);
    progressbar.addEventListener("click", seek);
    if (player.currentTime == player.duration) {
        $(pl).closest(".audio-player").find(".play-button").removeClass('pause');
        $(pl).closest(".audio-player").find(".album-image").removeAttr("style")
    }
    function seek(evt) {
        var percent = evt.offsetX / this.offsetWidth;
        player.currentTime = percent * player.duration;
        progressbar.value = percent / 100;
    }
};
function initPlayers(pl) {
    // pass num in if there are multiple audio players e.g 'player' + i
    (function() {
        // Variables
        // ----------------------------------------------------------
        // audio embed object
        var playerContainer =pl.find(".audio-wrapper")[0],
            player =pl.find("audio")[0],
            isPlaying = false,
            playBtn =pl.find(".play-button")[0];

        // Controls Listeners
        // ----------------------------------------------------------
        if (playBtn != null) {
            playBtn.addEventListener('click', function() {
                togglePlay()
            });
        }
        // Controls & Sounds Methods
        // ----------------------------------------------------------
        function togglePlay() {
            if (player.paused === false) {
                player.pause();
                isPlaying = false;
                $(playBtn).removeClass('pause');
                imageUrl=window.SITE_URL+"storyeditor/viewer/themes/en/images/soundwave.png";
                $(playBtn).parent().children(".album-image").css('background-image', 'url(' + imageUrl + ')');

            } else {
                player.play();
                $(playBtn).addClass('pause');
                isPlaying = true;
               setTimeout(function () {
                   $(".start-time").show();
                   $(".end-time").show();
               },100);
                imageUrl=window.SITE_URL+"storyeditor/thems/En/images/soundanimation.gif";
                $(playBtn).parent().children(".album-image").css('background-image', 'url(' + imageUrl + ')');
            }
        }
    }());
}




